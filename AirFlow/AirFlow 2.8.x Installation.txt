Step-by-Step Installation for Apache Airflow 2.8.x on RHEL 8

---------------------------------------------------------------------------------------------
1. Update System
sudo dnf update -y
---------------------------------------------------------------------------------------------
2. Install Dependencies
sudo dnf install -y gcc openssl-devel bzip2-devel libffi-devel libpq-devel python39-devel wget
---------------------------------------------------------------------------------------------
3. Enable Python 3.9
sudo dnf module install -y python39
python3.9 --version  # Verify (should show 3.9.x)
---------------------------------------------------------------------------------------------
4. Create Virtual Environment
python3.9 -m venv ~/airflow-venv
source ~/airflow-venv/bin/activate
---------------------------------------------------------------------------------------------
5. Set Environment Variables
echo "export AIRFLOW_HOME=~/airflow" >> ~/.bashrc
source ~/.bashrc
---------------------------------------------------------------------------------------------
6. Install Airflow 2.8.1
pip install "apache-airflow[postgres]==2.8.1" \
  --constraint "https://raw.githubusercontent.com/apache/airflow/constraints-2.8.1/constraints-3.9.txt"
---------------------------------------------------------------------------------------------
7. Install PostgreSQL 15
sudo dnf install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-x86_64/pgdg-redhat-repo-latest.noarch.rpm
sudo dnf -qy module disable postgresql
sudo dnf install -y postgresql15-server postgresql15-contrib
---------------------------------------------------------------------------------------------
8. Configure PostgreSQL
sudo /usr/pgsql-15/bin/postgresql-15-setup initdb
sudo systemctl enable postgresql-15
sudo systemctl start postgresql-15

Edit authentication (/var/lib/pgsql/15/data/pg_hba.conf):
# Change to md5 for local and IPv4 connections:
host    all             all             127.0.0.1/32            md5
local   all             all                                     md5

Reload PostgreSQL:
sudo systemctl reload postgresql-15
---------------------------------------------------------------------------------------------
9. Create Airflow Database
sudo -u postgres psql -c "CREATE DATABASE airflow_db;"
sudo -u postgres psql -c "CREATE USER airflow WITH PASSWORD 'your_secure_password';"
sudo -u postgres psql -c "GRANT ALL PRIVILEGES ON DATABASE airflow_db TO airflow;"
---------------------------------------------------------------------------------------------
10. Configure Airflow
Edit ~/airflow/airflow.cfg:

[core]
sql_alchemy_conn = postgresql+psycopg2://airflow:your_secure_password@localhost/airflow_db
executor = LocalExecutor  # For production, use CeleryExecutor
---------------------------------------------------------------------------------------------
11. Initialize Airflow Database
airflow db init
---------------------------------------------------------------------------------------------
12. Create Admin User
airflow users create \
  --username admin \
  --firstname Admin \
  --lastname User \
  --role Admin \
  --email admin@example.com \
  --password admin_password_here
---------------------------------------------------------------------------------------------
13. Start Airflow Services
Option 1: Manual Start

airflow webserver --port 8080 -D  # Daemon mode
airflow scheduler -D

Option 2: Systemd Services (Recommended)
Create /etc/systemd/system/airflow-webserver.service:

[Unit]
Description=Airflow Webserver
After=network.target postgresql-15.service

[Service]
User=your_username
Group=your_username
Environment="AIRFLOW_HOME=/home/your_username/airflow"
ExecStart=/home/your_username/airflow-venv/bin/airflow webserver --port 8080
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target

Create /etc/systemd/system/airflow-scheduler.service:

[Unit]
Description=Airflow Scheduler
After=network.target postgresql-15.service

[Service]
User=your_username
Group=your_username
Environment="AIRFLOW_HOME=/home/your_username/airflow"
ExecStart=/home/your_username/airflow-venv/bin/airflow scheduler
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target

Enable services:

sudo systemctl daemon-reload
sudo systemctl enable airflow-webserver airflow-scheduler
sudo systemctl start airflow-webserver airflow-scheduler
---------------------------------------------------------------------------------------------
14. Open Firewall
sudo firewall-cmd --permanent --add-port=8080/tcp
sudo firewall-cmd --reload
---------------------------------------------------------------------------------------------
15. Access UI
http://your_server_ip:8080


  
